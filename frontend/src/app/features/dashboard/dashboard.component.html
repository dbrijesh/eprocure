<div class="dashboard">
  <div class="dashboard-header">
    <div>
      <h1>Dashboard</h1>
      <p class="subtitle">Overview of your procurement projects</p>
    </div>
    <button mat-raised-button color="primary" (click)="openNewProjectDialog()">
      <mat-icon>add</mat-icon>
      New Project
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading()" class="loading-state">
    <p>Loading dashboard data...</p>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid" *ngIf="!loading() && statistics() as stats">
    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-info">
          <span class="stat-title">Total Projects</span>
          <h2 class="stat-value">{{ stats.totalProjects }}</h2>
          <p class="stat-description">All procurement projects</p>
        </div>
        <div class="stat-icon" style="background-color: #1e293b">
          <mat-icon>bar_chart</mat-icon>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-info">
          <span class="stat-title">Active</span>
          <h2 class="stat-value">{{ stats.activeProjects }}</h2>
          <p class="stat-description">Currently in progress</p>
          <span class="stat-trend positive" *ngIf="stats.activeProjectsChangePercent">
            +{{ stats.activeProjectsChangePercent }}% vs last month
          </span>
        </div>
        <div class="stat-icon" style="background-color: #10b981">
          <mat-icon>play_circle</mat-icon>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-info">
          <span class="stat-title">Completed</span>
          <h2 class="stat-value">{{ stats.completedProjects }}</h2>
          <p class="stat-description">Successfully finished</p>
        </div>
        <div class="stat-icon" style="background-color: #3b82f6">
          <mat-icon>check_circle</mat-icon>
        </div>
      </div>
    </mat-card>

    <mat-card class="stat-card">
      <div class="stat-content">
        <div class="stat-info">
          <span class="stat-title">Total Budget</span>
          <h2 class="stat-value">€{{ stats.totalBudget | number:'1.0-0' }}</h2>
          <p class="stat-description">Across all projects</p>
        </div>
        <div class="stat-icon" style="background-color: #8b5cf6">
          <mat-icon>euro</mat-icon>
        </div>
      </div>
    </mat-card>
  </div>

  <!-- Recent Projects and Sidebar -->
  <div class="content-grid" *ngIf="!loading()">
    <mat-card class="recent-projects">
      <div class="section-header">
        <div>
          <h3>Recent Projects</h3>
          <p>Your most recently created projects</p>
        </div>
        <button mat-button>View all →</button>
      </div>

      <div class="projects-list" *ngIf="recentProjects().length > 0; else noProjects">
        <div class="project-item" *ngFor="let project of recentProjects()">
          <div class="project-info">
            <h4>{{ project.title }}</h4>
            <p>{{ project.description }}</p>
            <span class="project-budget">€{{ project.budget | number }}</span>
          </div>
          <span class="project-status" [ngClass]="project.status.toLowerCase()">
            {{ project.status }}
          </span>
        </div>
      </div>

      <ng-template #noProjects>
        <div class="empty-state">
          <mat-icon>folder_open</mat-icon>
          <h3>No projects yet</h3>
          <p>Create your first procurement project to get started</p>
          <button mat-raised-button color="primary" (click)="openNewProjectDialog()">
            <mat-icon>add</mat-icon>
            Create Project
          </button>
        </div>
      </ng-template>
    </mat-card>

    <div class="sidebar-widgets">
      <mat-card class="quick-actions">
        <h3>Quick Actions</h3>
        <p>Common tasks and shortcuts</p>
        <button mat-button class="action-btn" (click)="openNewProjectDialog()">
          <mat-icon>add</mat-icon> Create New Project
        </button>
        <button mat-button class="action-btn">
          <mat-icon>draft</mat-icon> View Draft Projects
        </button>
        <button mat-button class="action-btn">
          <mat-icon>schedule</mat-icon> View Active Projects
        </button>
      </mat-card>

      <mat-card class="project-status-widget" *ngIf="statistics() as stats">
        <h3>Project Status</h3>
        <p>Distribution by status</p>
        <div class="status-list">
          <div class="status-item">
            <span class="status-dot active"></span>
            <span>Active</span>
            <span class="status-count">{{ stats.activeProjects }}</span>
          </div>
          <div class="status-item">
            <span class="status-dot completed"></span>
            <span>Completed</span>
            <span class="status-count">{{ stats.completedProjects }}</span>
          </div>
          <div class="status-item">
            <span class="status-dot draft"></span>
            <span>Draft</span>
            <span class="status-count">{{ stats.draftProjects }}</span>
          </div>
        </div>
      </mat-card>
    </div>
  </div>
</div>
